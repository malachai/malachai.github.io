{"componentChunkName":"component---src-templates-blog-post-js","path":"/spe-oggraphimageurl/","result":{"data":{"site":{"siteMetadata":{"title":"Missing Wires"}},"markdownRemark":{"id":"6038c7a6-454e-5bd8-ae3f-e6796d15751a","excerpt":"This script will start at the $rootItem and for each child matching the $sourceTemplate will attempt to extract the Image field (if it exists) and copy this toâ€¦","html":"<p>This script will start at the $rootItem and for each child matching the $sourceTemplate will attempt to extract the Image field (if it exists) and copy this to the OpenGraphImageUrl field</p>\n<pre><code>$rootItem = Get-Item \"{GUID-HERE}\"\n$sourceTemplate = Get-Item \"{GUID-HERE}\";\n\nNew-UsingBlock (New-Object Sitecore.Data.BulkUpdateContext)\n{\n    Get-ChildItem $rootItem.FullPath -Recurse | Where-Object { $_.TemplateName -eq $sourceTemplate.Name } | ForEach-Object \n    {\n        if(![string]::IsNullOrEmpty($_.Image))\n        {\n            if ($_.Image -like '*>&#x3C;/image>*') {\n                $ogImage = $_.Image -replace \">&#x3C;/image>\", \"height=`\"675`\" width=`\"1200`\" />\"\n                Write-Host \"$($_.Image) -> $ogImage\"\n            }\n            elseif ($_.Image -like '*/>*') {\n                $ogImage = $_.Image -replace \"/>\", \"height=`\"675`\" width=`\"1200`\" />\"    \n                Write-Host \"$($_.Image) -> $ogImage\"            \n            }\n            $_.OpenGraphImageUrl = $_.Image\n            Publish-Item -Item $_\n        }\n    }\n}\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29d0f68597f8a3cc948b134428b40b40/df6e5/daria.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.6394446712944%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgT/xAAVAQEBAAAAAAAAAAAAAAAAAAABA//aAAwDAQACEAMQAAABpKGVlpAX/8QAGBABAQEBAQAAAAAAAAAAAAAAAQACEUH/2gAIAQEAAQUCUjSRpvNFk4f/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGn/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQIBAT8BR//EABoQAAEFAQAAAAAAAAAAAAAAABAAAQIRIVH/2gAIAQEABj8CxUIv0//EAB0QAAICAQUAAAAAAAAAAAAAAAABESFBMVFhcYH/2gAIAQEAAT8hkNwS4ID0Q6ZL3CWZZwVOvZ//2gAMAwEAAgADAAAAEBgP/8QAFxEBAAMAAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxBLZDS5/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxDDJBxv/8QAGhABAQADAQEAAAAAAAAAAAAAAREAMUEhwf/aAAgBAQABPxAoMBHhMEGMaUonzAECB3BmtQCEoymazC8k1h0O9u3vuf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Social Graf\"\n        title=\"Social Graf\"\n        src=\"/static/29d0f68597f8a3cc948b134428b40b40/f67cc/daria.jpg\"\n        srcset=\"/static/29d0f68597f8a3cc948b134428b40b40/9c38a/daria.jpg 200w,\n/static/29d0f68597f8a3cc948b134428b40b40/28275/daria.jpg 400w,\n/static/29d0f68597f8a3cc948b134428b40b40/f67cc/daria.jpg 800w,\n/static/29d0f68597f8a3cc948b134428b40b40/6e525/daria.jpg 1200w,\n/static/29d0f68597f8a3cc948b134428b40b40/e735c/daria.jpg 1600w,\n/static/29d0f68597f8a3cc948b134428b40b40/df6e5/daria.jpg 2449w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"SPE SXA Updating OgGraphImageUrl","date":"December 08, 2019","description":"Sitecore Powershell Script to bulk update SXA OgGraphImageUrl"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/spe-oggraphimageurl/","previous":{"fields":{"slug":"/spe-create-item-for-media-item/"},"frontmatter":{"title":"SPE Create Items based on Media Folder"}},"next":null}}}