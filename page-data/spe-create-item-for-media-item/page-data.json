{"componentChunkName":"component---src-templates-blog-post-js","path":"/spe-create-item-for-media-item/","result":{"data":{"site":{"siteMetadata":{"title":"Missing Wires"}},"markdownRemark":{"id":"aee2c09b-7e34-5ec3-aa11-8d61da9bef8e","excerpt":"This script walk through each item in the media folder and create a matching item (in this case setting the File and sxatags field) in the content tree","html":"<p>This script walk through each item in the media folder and create a matching item (in this case setting the File and sxatags field) in the content tree</p>\n<pre><code>function ProcessChildren($path)\n{\n    $childItems = Get-Item master: -Query $path\"/*\"\n    $childItems | ForEach-Object {\n        \n        $newPath = $_.FullPath -replace \"/sitecore/media library/...\", \"/sitecore/content/...\"\n        \n        $exists = Test-Path -Path $newPath\n        \n        if($exists -eq $true)\n        {\n            Write-Output \"$newPath exists\"\n        }\n        else\n        {\n            # If it's a media folder\n            if($_.TemplateID -eq \"{FE5DD826-48C6-436D-B87A-7C4210C7413B}\")\n            {\n                # Create a matching File Folder\n                $folder = New-Item $newPath -itemtype \"{FA81B07C-B634-41B3-AC0D-33C74E829AF9}\"\n            }\n            else\n            {\n                Write-Host \"Creating: \" $newPath\n                $file = New-Item $newPath -itemtype \"&#x3C;TemplateGUID of new item>\"\n                \n                $filesrc = (($_.Id -replace \"-\",\"\") -replace \"{\",\"\") -replace \"}\",\"\"\n                $fileref = \"&#x3C;file mediaid=`\"$($_.Id)`\" src=`\"-/media/$filesrc.ashx`\" />\"\n                \n                $file.Editing.BeginEdit();\n                $file.File = $fileref\n                $file.sxatags = \"&#x3C;SXA tagIds if required>\"\n                $file.Editing.EndEdit();\n            }\n        }\n        ProcessChildren($_.FullPath)\n    }\n}\n\nProcessChildren(\"/sitecore/....\");\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2aa55fa562248a3b98cea4622752b886/14e05/1280px-Omega-exp-omega-labeled.svg.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 123.046875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsSAAALEgHS3X78AAACPElEQVQ4y71VS4saQRAep3ceq87DjUl2ZjWPWWQlEDQSd/NYcGGE+BdCSEQMuawI5pKb0VzMJQiCBw8BD4oXPQVyyI8wv8V/kCqpCb2dVXGRFHxMdc90dX1fVfdI0nq7BXgv7dDigA+7DLhH2JlpAON/BgxtGxAXyMIcjo8B9wDqNoHQTgFlQBjAuPc2IHETyg8BLwBRwCGXsb5NEIUWaBwlj3ryAGBtQ3Of2mRJjzF2BLig7EzKWBUy1FZtolOwpX6yLHtE90k8Hrc8z1NowztC5XH+ESAi0gxENyDYOTxTpVIpW6vV3oEfA9ym9xHKSKFxlN4zkWpgJ7quo1aH2WzWLxQKn1ut1vlgMHhGRxHNCoVCbJV2jIuOdBzTNB2kOx6P38xms+/NZrNbLpdPqV0ky7I0kaJ4GnTCA8MwkM5ZPp+/mE6nP3u93u9ut/ttNBpdzufzT5PJ5CUWJplM8qyuFGqP9MDJo0Qigf7TTCbzvFqt/gC6vyDgx2KxeFapVErtdtvFxbCxxkl2lzrhb4bB8ULtlHA4fALPx41G43W/3/8KfrrT6fiu66bxI5DE5GRiVPUrGaqcHxyppO/7r+r1+lvwc8Ph8MtisUC6kuM4a5ub8f1Huzm5XI5RkdLQRsvqQuY2+LFrLot/bF+4SDEDT1XV+6lUCqup2LZ9cE1l7aDyq25njRsbJDRKEINirVoTXXcpMKEvkaorbKQKEm20KOkic8eL/7fo62huusYinMaRTYW4ye9go/0BGBFKjBq+L5sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Recursion\"\n        title=\"Recursion\"\n        src=\"/static/2aa55fa562248a3b98cea4622752b886/11d19/1280px-Omega-exp-omega-labeled.svg.png\"\n        srcset=\"/static/2aa55fa562248a3b98cea4622752b886/40714/1280px-Omega-exp-omega-labeled.svg.png 200w,\n/static/2aa55fa562248a3b98cea4622752b886/a8246/1280px-Omega-exp-omega-labeled.svg.png 400w,\n/static/2aa55fa562248a3b98cea4622752b886/11d19/1280px-Omega-exp-omega-labeled.svg.png 800w,\n/static/2aa55fa562248a3b98cea4622752b886/f0628/1280px-Omega-exp-omega-labeled.svg.png 1200w,\n/static/2aa55fa562248a3b98cea4622752b886/14e05/1280px-Omega-exp-omega-labeled.svg.png 1280w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"SPE Create Items based on Media Folder","date":"November 05, 2019","description":"Sitecore Powershell Script for creating items for each media item"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/spe-create-item-for-media-item/","previous":null,"next":{"fields":{"slug":"/spe-oggraphimageurl/"},"frontmatter":{"title":"SPE SXA Updating OgGraphImageUrl"}}}}}