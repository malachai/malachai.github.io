{"componentChunkName":"component---src-templates-post-jsx","path":"/blog/spe-create-item-for-media-item","result":{"data":{"prismic":{"allPosts":{"edges":[{"node":{"post_body":[{"type":"paragraph","text":"This script walk through each item in the media folder and create a matching item (in this case setting the File and sxatags field) in the content tree","spans":[]},{"type":"preformatted","text":"function ProcessChildren($path)\n{\n    $childItems = Get-Item master: -Query $path\"/*\"\n    $childItems | ForEach-Object {\n        \n        $newPath = $_.FullPath -replace \"/sitecore/media library/...\", \"/sitecore/content/...\"\n        \n        $exists = Test-Path -Path $newPath\n        \n        if($exists -eq $true)\n        {\n            Write-Output \"$newPath exists\"\n        }\n        else\n        {\n            # If it's a media folder\n            if($_.TemplateID -eq \"{FE5DD826-48C6-436D-B87A-7C4210C7413B}\")\n            {\n                # Create a matching File Folder\n                $folder = New-Item $newPath -itemtype \"{FA81B07C-B634-41B3-AC0D-33C74E829AF9}\"\n            }\n            else\n            {\n                Write-Host \"Creating: \" $newPath\n                $file = New-Item $newPath -itemtype \"<TemplateGUID of new item>\"\n                \n                $filesrc = (($_.Id -replace \"-\",\"\") -replace \"{\",\"\") -replace \"}\",\"\"\n                $fileref = \"<file mediaid=`\"$($_.Id)`\" src=`\"-/media/$filesrc.ashx`\" />\"\n                \n                $file.Editing.BeginEdit();\n                $file.File = $fileref\n                $file.sxatags = \"<SXA tagIds if required>\"\n                $file.Editing.EndEdit();\n            }\n        }\n        ProcessChildren($_.FullPath)\n    }\n}\n\nProcessChildren(\"/sitecore/....\");","spans":[]}],"title":"SPE Create Items based on Media Folder","category":"Scripts","date":"2019-11-05","excerpt":"This script walks through each item in the media folder and create a matching item (in this case setting the File and sxatags field) in the content tree","tags":[{"tag":{"_linkType":"Link.document","name":"SXA"}},{"tag":{"_linkType":"Link.document","name":"SPE"}}],"image":{"dimensions":{"width":980,"height":613},"alt":null,"copyright":null,"url":"https://images.prismic.io/missingwires/44a53c3b-e945-425b-80b1-2ef3034a3c13_deepdream.jpg?auto=compress,format"}}}]}}},"pageContext":{"rootQuery":"\nquery BlogPostQuery($uid: String) {\n  prismic {\n    allPosts(uid: $uid) {\n      edges {\n        node {\n          post_body\n          title\n          category\n          date\n          excerpt\n          tags {\n            tag {\n              _linkType\n              ... on PRISMIC_Tag {\n                name\n                _linkType\n              }\n            }\n          }\n          image\n        }\n      }\n    }\n  }\n}\n","id":"XhuthhUAACQAKBfW","lang":"en-au","uid":"spe-create-item-for-media-item","type":"post","alternateLanguages":[],"cursor":"YXJyYXljb25uZWN0aW9uOjE=","paginationPreviousMeta":{"id":"XhutWRUAACQAKBcm","lang":"en-au","uid":"spe-oggraphimageurl","type":"post","alternateLanguages":[]},"paginationPreviousUid":"spe-oggraphimageurl","paginationPreviousLang":"en-au","paginationNextMeta":null,"paginationNextUid":"","paginationNextLang":"","lastQueryChunkEndCursor":""}}}